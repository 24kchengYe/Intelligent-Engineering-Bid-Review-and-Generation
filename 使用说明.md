# 智能标书审查系统 - 使用说明

## 一、启动系统

### 方法1：使用批处理文件（推荐）
双击 `启动系统.bat` 文件

### 方法2：命令行启动
```bash
# 在项目目录下打开命令行，执行：
streamlit run app.py
```

启动成功后，浏览器会自动打开 http://localhost:8501

---

## 二、完整操作流程

### 📄 步骤1：文件上传

1. **填写项目名称**：在顶部输入框输入项目名称（必填）

2. **上传文件**：根据实际情况上传文件（所有文件都是可选的）

   **招标文件（前2项）**：
   - 招标文件正文（支持 PDF/Word/Excel）
   - 技术要求附件（支持 PDF/Word/Excel）

   **招标文件附件（后4项）**：
   - 工程量清单（通常为 Excel）
   - 评审标准附件
   - 施工设计说明
   - 方案建议书附件

3. **保存项目**：点击 `💾 保存项目` 按钮

   ✅ 看到"项目已保存"提示后，继续下一步

---

### 📊 步骤2：标书分析（结构化解析）

1. **切换到"标书分析"标签页**
   - 在页面顶部找到三个标签：`📄 文件上传` | `📊 标书分析` | `📝 投标文件生成`
   - 点击 `📊 标书分析`

2. **开始解析**：点击 `🚀 开始结构化解析` 按钮
   - 等待1-2分钟，AI会对招标文件进行7大类别的结构化解析

3. **查看解析结果**（左右分栏显示）：
   - **左侧**：7大类别的结构化解析结果
     - 1. 基础信息
     - 2. 资格要求
     - 3. 评审要求
     - 4. 投标文件要求
     - 5. 无效标与废标项
     - 6. 应标需提交文件
     - 7. 招标文件审查
   - **右侧**：原始招标文件内容（可选择不同文件查看）

4. **导出解析报告**（可选）：
   - 点击 `📥 导出解析报告(MD)` 或 `📥 导出解析报告(TXT)`

5. **提取评审标准**：点击 `📋 提取评审标准` 按钮
   - 这一步是为生成技术标做准备
   - ✅ 看到"评审标准提取完成"提示后，继续下一步

---

### 📝 步骤3：技术标文件生成

1. **切换到"投标文件生成"标签页**
   - 点击顶部的 `📝 投标文件生成` 标签

2. **生成技术标目录**：
   - 点击 `🏗️ 生成技术标目录` 按钮
   - AI会根据评审标准自动生成技术标的目录结构
   - 目录中会标注每个章节的建议字数

3. **分步生成章节**：
   - 在下拉框中选择要生成的章节
   - 点击 `✍️ 生成此章节` 按钮
   - 重复此步骤，逐个生成所有章节
   - 系统会显示进度：`📊 进度: X/Y 个章节已生成`

4. **查看已生成章节**：
   - 点击章节名称可展开查看内容
   - 每个章节下方会显示字数统计

5. **导出技术标文档**：
   - 点击 `📥 导出完整技术标(MD)` 或 `📥 导出完整技术标(TXT)`
   - 系统会将所有已生成的章节合并成完整文档

---

## 三、历史记录管理

### 查看历史项目
- 左侧边栏显示所有历史项目
- 点击项目可展开查看详情

### 加载历史项目
- 点击 `📂 加载` 按钮可重新加载历史项目
- 所有文件和分析结果会自动恢复

### 删除项目
1. 点击 `🗑️ 删除` 按钮
2. 系统会显示确认对话框，列出将要删除的内容
3. 点击 `✅ 确认删除` 完成删除
   - 会同时删除数据库记录和关联的文件

### 新建项目
- 点击左侧边栏底部的 `➕ 新建项目` 按钮
- 系统会清空当前状态，开始新项目

---

## 四、常见问题

### Q1: 上传文件时提示403错误
**解决方案**：
1. 使用 `启动系统.bat` 启动（已禁用XSRF保护）
2. 或使用此命令启动：
   ```bash
   streamlit run app.py --server.enableCORS false --server.enableXsrfProtection false
   ```
3. 清除浏览器缓存和Cookie后重试

### Q2: 文件上传后找不到下一步操作
**解决方案**：
1. 确保点击了 `💾 保存项目` 按钮
2. 切换到顶部的 `📊 标书分析` 标签页
3. 点击 `🚀 开始结构化解析` 按钮

### Q3: AI处理时间过长
**说明**：
- 结构化解析通常需要1-2分钟
- 章节生成通常需要30-60秒
- 请耐心等待，不要刷新页面

### Q4: 生成的内容不满意怎么办
**解决方案**：
- 可以重新点击生成按钮覆盖之前的内容
- 也可以下载后手动编辑修改

---

## 五、系统架构说明

### 文件存储位置
- **上传文件**：`database/` 目录
- **数据库**：`data/bidding_system.db`

### 数据保存机制
- 上传文件后即自动保存到本地
- 点击"保存项目"会保存到数据库
- AI分析结果自动保存
- 关闭浏览器后数据不会丢失

---

## 六、技术支持

如遇到其他问题，请检查：
1. Python版本（需要3.9+）
2. 依赖包是否完整安装（`pip install -r requirements.txt`）
3. .env文件中的API密钥是否正确配置
