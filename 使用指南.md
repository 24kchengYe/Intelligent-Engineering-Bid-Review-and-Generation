# 智能标书审查系统 - 使用指南

## 快速开始

### 1. 安装依赖

**Windows 用户**：
```bash
pip install -r requirements.txt
```

**Mac/Linux 用户**：
```bash
pip3 install -r requirements.txt
```

### 2. 配置 API Key

1. 复制 `.env.example` 文件并重命名为 `.env`
2. 编辑 `.env` 文件，填入你的 Anthropic Claude API Key：

```
ANTHROPIC_API_KEY=sk-ant-api03-xxxxxxxxxxxx
```

如果还没有 API Key，请访问：https://console.anthropic.com/

### 3. 启动系统

**方法一：使用启动脚本（推荐）**

Windows 双击运行：`start.bat`

Mac/Linux 执行：
```bash
chmod +x start.sh
./start.sh
```

**方法二：手动启动**
```bash
streamlit run app.py
```

系统将自动在浏览器中打开，默认地址：http://localhost:8501

## 功能使用

### 一、上传标书文件

1. 在"文件上传"标签页，输入**项目名称**
2. 根据实际情况上传文件：
   - **PDF规范**：招标文件、技术规范等
   - **Word方案**：技术方案要求、商务条款等
   - **Excel清单**：工程量清单、报价表等
   - **其他附件**：补充材料
3. 点击"保存项目"按钮

**注意**：
- 所有文件类型都是可选的，可根据实际需要上传
- 系统支持 PDF、Word（.docx/.doc）、Excel（.xlsx/.xls）格式
- 文件会自动解析并提取文本内容

### 二、标书智能分析

1. 切换到"标书分析"标签页
2. 点击"开始AI分析"按钮
3. 等待 Claude AI 分析（通常需要 30-60 秒）
4. 查看生成的分析报告

**分析报告内容包括**：
- 项目概况总结
- 技术要求分析
- 商务条款解读
- 资质要求清单
- 风险点识别
- 重点关注事项
- 投标建议

5. 可以下载报告为 Markdown 格式保存

### 三、生成投标文件

1. 完成标书分析后，切换到"投标文件生成"标签页
2. （可选）在"特殊要求"框中输入额外说明，例如：
   - "突出我司在智慧城市领域的优势"
   - "强调某某项目的成功经验"
3. 点击"生成投标文件"按钮
4. 等待 AI 生成（通常需要 30-60 秒）
5. 查看和下载生成的投标文件

**生成内容包括**：
- 技术方案响应
- 商务条款响应
- 资质证明材料清单
- 质量保证措施
- 售后服务方案

### 四、历史记录管理

在左侧边栏可以：
- 查看所有历史项目
- 搜索特定项目
- 加载历史项目继续编辑
- 新建新项目

## 常见问题

### Q1: 提示找不到 API Key
**解决方法**：
1. 确认 `.env` 文件存在（不是 `.env.example`）
2. 确认文件中 `ANTHROPIC_API_KEY=` 后面已填入有效的 Key
3. 重启应用

### Q2: API 调用失败
**可能原因**：
- API Key 无效或过期
- 网络无法访问 Anthropic API
- API 配额用完

**解决方法**：
- 检查 API Key 是否正确
- 确认网络连接正常
- 检查 API 账户余额

### Q3: 文件解析失败
**可能原因**：
- 文件格式不支持
- 文件损坏
- 文件被加密或有密码保护

**解决方法**：
- 确认文件格式为 PDF、Word 或 Excel
- 尝试重新保存文件
- 移除文件密码保护

### Q4: 分析报告不够详细
**建议**：
- 上传更完整的标书文件
- 在投标文件生成时，在"特殊要求"中补充更多背景信息
- 可以多次生成，逐步优化

### Q5: 如何修改 AI 模型
在 `modules/ai_service.py` 中修改 `self.model` 变量，可选：
- `claude-sonnet-4-20250514`（默认，平衡性能）
- `claude-opus-4-20250514`（最强性能，成本较高）

## 系统架构

```
智能标书审查系统/
├── app.py                    # Streamlit 主应用
├── modules/                  # 核心模块
│   ├── document_parser.py    # 文档解析（PDF/Word/Excel）
│   ├── ai_service.py         # Claude API 封装
│   └── database.py           # SQLite 数据库
├── uploads/                  # 上传文件存储
├── data/                     # 数据库文件
├── requirements.txt          # Python 依赖
├── .env                      # 环境配置（需自行创建）
└── README.md                 # 项目说明
```

## 数据安全

- 所有数据存储在本地
- 上传的文件保存在 `uploads/` 目录
- 项目记录保存在本地 SQLite 数据库
- 只有文件内容会发送到 Claude API 进行分析

## 后续扩展建议

1. **导出功能增强**
   - 支持导出为 Word/PDF 格式
   - 自定义报告模板

2. **批量处理**
   - 一次处理多个标书项目
   - 对比分析功能

3. **模板管理**
   - 保存常用的分析模板
   - 预设行业模板（建筑、IT、制造等）

4. **协作功能**
   - 多人协作审查
   - 审批流程

5. **用户权限**
   - 添加用户登录
   - 权限分级管理

## 技术支持

如遇问题，请检查：
1. Python 版本是否 ≥ 3.9
2. 所有依赖是否正确安装
3. `.env` 配置是否正确
4. 网络连接是否正常

## 更新日志

### v1.0.0 (2026-01-14)
- 初始版本
- 支持 PDF、Word、Excel 文件解析
- 集成 Claude AI 智能分析
- 标书审查报告生成
- 投标文件生成
- 历史记录管理

---

**Happy Bidding!** 祝你投标顺利！
